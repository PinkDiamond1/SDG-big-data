<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Migration Patterns | Big Data Analytics</title>
  <meta name="description" content="SDG Bookdown" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Migration Patterns | Big Data Analytics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="SDG Bookdown" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Migration Patterns | Big Data Analytics" />
  
  <meta name="twitter:description" content="SDG Bookdown" />
  

<meta name="author" content="Chapter 8 Migration Patterns | Big Data Analytics Group" />


<meta name="date" content="2021-08-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mobility.html"/>
<link rel="next" href="optimization.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Big Data Analysis</a></li>

<li class="divider"></li>
<li class="part"><span><b>Cover</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Cover</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#gps-analytics"><i class="fa fa-check"></i><b>1.1</b> <span>GPS Analytics</span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#labor-market-analysis-with-twitter-data"><i class="fa fa-check"></i><b>1.2</b> <span>Labor market analysis with Twitter data</span></a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#news-analysis-with-twitter-data"><i class="fa fa-check"></i><b>1.3</b> <span>News analysis with Twitter data</span></a></li>
</ul></li>
<li class="part"><span><b>GPS Analytics</b></span></li>
<li class="chapter" data-level="2" data-path="gps.html"><a href="gps.html"><i class="fa fa-check"></i><b>2</b> Introduction - GPS</a></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#gps-data"><i class="fa fa-check"></i><b>3.1</b> GPS Data</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#wealth-index-data"><i class="fa fa-check"></i><b>3.2</b> Wealth Index Data</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#administrative-boundaries-data"><i class="fa fa-check"></i><b>3.3</b> Administrative Boundaries Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocode.html"><a href="geocode.html"><i class="fa fa-check"></i><b>4</b> Geocode</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocode.html"><a href="geocode.html#efficient-spatial-joining-and-geospatial-indexing"><i class="fa fa-check"></i><b>4.1</b> Efficient spatial joining and Geospatial Indexing</a></li>
<li class="chapter" data-level="4.2" data-path="geocode.html"><a href="geocode.html#code"><i class="fa fa-check"></i><b>4.2</b> Code</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="geocode.html"><a href="geocode.html#loading-administrative-units"><i class="fa fa-check"></i><b>4.2.1</b> Loading administrative units</a></li>
<li class="chapter" data-level="4.2.2" data-path="geocode.html"><a href="geocode.html#loading-ping-data-and-h3-indexing"><i class="fa fa-check"></i><b>4.2.2</b> Loading ping data and h3 indexing</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="geocode.html"><a href="geocode.html#initial-coarse-geo-spatial-join-with-shapefiles"><i class="fa fa-check"></i><b>4.3</b> Initial coarse geo-spatial join with shapefiles</a></li>
<li class="chapter" data-level="4.4" data-path="geocode.html"><a href="geocode.html#final-exact-join-with-a-subset-of-the-shapefiles"><i class="fa fa-check"></i><b>4.4</b> Final exact join with a subset of the shapefiles</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stops.html"><a href="stops.html"><i class="fa fa-check"></i><b>5</b> Finding Stops</a>
<ul>
<li class="chapter" data-level="5.1" data-path="stops.html"><a href="stops.html#definition"><i class="fa fa-check"></i><b>5.1</b> Definition</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="stops.html"><a href="stops.html#get-stop-locations"><i class="fa fa-check"></i><b>5.1.1</b> Get stop locations</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="stops.html"><a href="stops.html#clustering-recurrent-stops"><i class="fa fa-check"></i><b>5.2</b> Clustering recurrent stops</a></li>
<li class="chapter" data-level="5.3" data-path="stops.html"><a href="stops.html#appending-pings-from-recent-dates"><i class="fa fa-check"></i><b>5.3</b> Appending pings from recent dates</a></li>
<li class="chapter" data-level="5.4" data-path="stops.html"><a href="stops.html#stops-geocoding"><i class="fa fa-check"></i><b>5.4</b> Stops geocoding</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="labeling.html"><a href="labeling.html"><i class="fa fa-check"></i><b>6</b> Defining Home and Work Locations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="labeling.html"><a href="labeling.html#seasonal-patterns"><i class="fa fa-check"></i><b>6.1</b> Seasonal patterns</a></li>
<li class="chapter" data-level="6.2" data-path="labeling.html"><a href="labeling.html#code-1"><i class="fa fa-check"></i><b>6.2</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mobility.html"><a href="mobility.html"><i class="fa fa-check"></i><b>7</b> Mobility Patterns</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mobility.html"><a href="mobility.html#socio-economic-groups"><i class="fa fa-check"></i><b>7.1</b> Socio-economic groups</a></li>
<li class="chapter" data-level="7.2" data-path="mobility.html"><a href="mobility.html#selection"><i class="fa fa-check"></i><b>7.2</b> Individual’s selection</a></li>
<li class="chapter" data-level="7.3" data-path="mobility.html"><a href="mobility.html#measures"><i class="fa fa-check"></i><b>7.3</b> Measures</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="mobility.html"><a href="mobility.html#measuring-mobility-patterns"><i class="fa fa-check"></i><b>7.3.1</b> Measuring mobility patterns</a></li>
<li class="chapter" data-level="7.3.2" data-path="mobility.html"><a href="mobility.html#measuring-change"><i class="fa fa-check"></i><b>7.3.2</b> Measuring change</a></li>
<li class="chapter" data-level="7.3.3" data-path="mobility.html"><a href="mobility.html#home-isolated-commuters-and-low-wealth-commuters"><i class="fa fa-check"></i><b>7.3.3</b> Home-isolated, commuters and low-wealth commuters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="migration.html"><a href="migration.html"><i class="fa fa-check"></i><b>8</b> Migration Patterns</a>
<ul>
<li class="chapter" data-level="8.1" data-path="migration.html"><a href="migration.html#description"><i class="fa fa-check"></i><b>8.1</b> Description</a></li>
<li class="chapter" data-level="8.2" data-path="migration.html"><a href="migration.html#user-selection"><i class="fa fa-check"></i><b>8.2</b> User selection</a></li>
<li class="chapter" data-level="8.3" data-path="migration.html"><a href="migration.html#code-2"><i class="fa fa-check"></i><b>8.3</b> Code</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>9</b> Location labeling and parameter optimization</a>
<ul>
<li class="chapter" data-level="9.1" data-path="optimization.html"><a href="optimization.html#ground-truth"><i class="fa fa-check"></i><b>9.1</b> Ground truth</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="optimization.html"><a href="optimization.html#construction"><i class="fa fa-check"></i><b>9.1.1</b> Construction</a></li>
<li class="chapter" data-level="9.1.2" data-path="optimization.html"><a href="optimization.html#validation"><i class="fa fa-check"></i><b>9.1.2</b> Validation</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="optimization.html"><a href="optimization.html#parameter-optimization"><i class="fa fa-check"></i><b>9.2</b> Parameter optimization</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="optimization.html"><a href="optimization.html#performance-indicators"><i class="fa fa-check"></i><b>9.2.1</b> Performance indicators</a></li>
<li class="chapter" data-level="9.2.2" data-path="optimization.html"><a href="optimization.html#performance-error-estimates-and-bootstrapping"><i class="fa fa-check"></i><b>9.2.2</b> Performance error estimates and bootstrapping</a></li>
<li class="chapter" data-level="9.2.3" data-path="optimization.html"><a href="optimization.html#parallel-bootstrapping-and-optimization-result-storage"><i class="fa fa-check"></i><b>9.2.3</b> Parallel bootstrapping and optimization result storage</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="optimization.html"><a href="optimization.html#parameter-configuration-selection"><i class="fa fa-check"></i><b>9.3</b> Parameter configuration selection</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="windex.html"><a href="windex.html"><i class="fa fa-check"></i><b>10</b> Wealth Index</a>
<ul>
<li class="chapter" data-level="10.1" data-path="windex.html"><a href="windex.html#variables-to-estimate-the-social-gap-index-in-mexico"><i class="fa fa-check"></i><b>10.1</b> Variables to estimate the Social Gap Index in Mexico</a></li>
<li class="chapter" data-level="10.2" data-path="windex.html"><a href="windex.html#education"><i class="fa fa-check"></i><b>10.2</b> Education</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="windex.html"><a href="windex.html#health-services-access"><i class="fa fa-check"></i><b>10.2.1</b> Health Services Access</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="windex.html"><a href="windex.html#household-characteristics"><i class="fa fa-check"></i><b>10.3</b> Household Characteristics</a></li>
<li class="chapter" data-level="10.4" data-path="windex.html"><a href="windex.html#assets-ownership"><i class="fa fa-check"></i><b>10.4</b> Assets Ownership</a></li>
</ul></li>
<li class="part"><span><b>Twitter Analytics - Labor Market</b></span></li>
<li class="chapter" data-level="11" data-path="labor.html"><a href="labor.html"><i class="fa fa-check"></i><b>11</b> Introduction - Labor Market</a>
<ul>
<li class="chapter" data-level="11.1" data-path="labor.html"><a href="labor.html#labor-market-analysis-with-twitter-data-1"><i class="fa fa-check"></i><b>11.1</b> Labor market analysis with Twitter data</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="training-data-preparation.html"><a href="training-data-preparation.html"><i class="fa fa-check"></i><b>12</b> Training data preparation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="training-data-preparation.html"><a href="training-data-preparation.html#sampling"><i class="fa fa-check"></i><b>12.1</b> Sampling</a></li>
<li class="chapter" data-level="12.2" data-path="training-data-preparation.html"><a href="training-data-preparation.html#labelling"><i class="fa fa-check"></i><b>12.2</b> Labelling</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="training-data-preparation.html"><a href="training-data-preparation.html#creating-a-qualtrics-survey"><i class="fa fa-check"></i><b>12.2.1</b> Creating a Qualtrics survey</a></li>
<li class="chapter" data-level="12.2.2" data-path="training-data-preparation.html"><a href="training-data-preparation.html#sharing-the-survey-on-mturk"><i class="fa fa-check"></i><b>12.2.2</b> Sharing the survey on MTurk</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="finetuning-bert-based-models.html"><a href="finetuning-bert-based-models.html"><i class="fa fa-check"></i><b>13</b> Finetuning BERT-based models</a>
<ul>
<li class="chapter" data-level="13.1" data-path="finetuning-bert-based-models.html"><a href="finetuning-bert-based-models.html#training-the-model"><i class="fa fa-check"></i><b>13.1</b> Training the model</a></li>
<li class="chapter" data-level="13.2" data-path="finetuning-bert-based-models.html"><a href="finetuning-bert-based-models.html#evaluation-on-the-random-set"><i class="fa fa-check"></i><b>13.2</b> Evaluation on the random set</a></li>
<li class="chapter" data-level="13.3" data-path="finetuning-bert-based-models.html"><a href="finetuning-bert-based-models.html#active-learning"><i class="fa fa-check"></i><b>13.3</b> Active learning</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="unemployment-indicators.html"><a href="unemployment-indicators.html"><i class="fa fa-check"></i><b>14</b> Unemployment indicators</a>
<ul>
<li class="chapter" data-level="14.1" data-path="unemployment-indicators.html"><a href="unemployment-indicators.html#building-unemployment-indicators-from-individual-tweets"><i class="fa fa-check"></i><b>14.1</b> Building unemployment indicators from individual tweets</a></li>
</ul></li>
<li class="part"><span><b>Twitter Analytics - News</b></span></li>
<li class="chapter" data-level="15" data-path="news.html"><a href="news.html"><i class="fa fa-check"></i><b>15</b> Introduction - News Analytics</a>
<ul>
<li class="chapter" data-level="15.1" data-path="news.html"><a href="news.html#news-articles"><i class="fa fa-check"></i><b>15.1</b> News articles</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="global-vs.-local-news-sentiment-indicators.html"><a href="global-vs.-local-news-sentiment-indicators.html"><i class="fa fa-check"></i><b>16</b> Global vs. local news sentiment indicators</a>
<ul>
<li class="chapter" data-level="16.1" data-path="global-vs.-local-news-sentiment-indicators.html"><a href="global-vs.-local-news-sentiment-indicators.html#local-news-sentiment-indicator"><i class="fa fa-check"></i><b>16.1</b> Local news sentiment indicator</a></li>
<li class="chapter" data-level="16.2" data-path="global-vs.-local-news-sentiment-indicators.html"><a href="global-vs.-local-news-sentiment-indicators.html#global-news-sentiment-indicator"><i class="fa fa-check"></i><b>16.2</b> Global news sentiment indicator</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="news-sentiment-measures.html"><a href="news-sentiment-measures.html"><i class="fa fa-check"></i><b>17</b> News-sentiment measures</a>
<ul>
<li class="chapter" data-level="17.1" data-path="news-sentiment-measures.html"><a href="news-sentiment-measures.html#bag-of-words-model"><i class="fa fa-check"></i><b>17.1</b> Bag-of-words model</a></li>
<li class="chapter" data-level="17.2" data-path="news-sentiment-measures.html"><a href="news-sentiment-measures.html#country-specific-news-sentiment-indicator"><i class="fa fa-check"></i><b>17.2</b> Country-specific news sentiment indicator</a></li>
<li class="chapter" data-level="17.3" data-path="news-sentiment-measures.html"><a href="news-sentiment-measures.html#stylized-facts"><i class="fa fa-check"></i><b>17.3</b> Stylized facts</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Big Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="migration" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Migration Patterns</h1>
<div id="description" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Description</h2>
<p>A great amount of <a href="https://www.nytimes.com/2021/05/12/opinion/New-York-San-Francisco-after-covid.html">media attention</a> has
been focusing on how large cities are being empitied out by the pandemic.
We are also interested in this behavior and used similar process as the described in the previous chapter <a href="mobility.html#mobility">7</a>,
and as the home labeling process we did allowed for multiple homes in a certain time window then we could
use a change of administrative unit in the residential location of the users. For this study we focused on the largest
city of each country:</p>
<table>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="left">Code</th>
<th align="left">City</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Brazil</td>
<td align="left">BR</td>
<td align="left">São Paulo</td>
</tr>
<tr class="even">
<td align="left">Colombia</td>
<td align="left">CO</td>
<td align="left">Bogota</td>
</tr>
<tr class="odd">
<td align="left">Indonesia</td>
<td align="left">ID</td>
<td align="left">Jakarta</td>
</tr>
<tr class="even">
<td align="left">Mexico</td>
<td align="left">MX</td>
<td align="left">Mexico City</td>
</tr>
<tr class="odd">
<td align="left">Philippines</td>
<td align="left">PH</td>
<td align="left">Quezon City (Manila)</td>
</tr>
<tr class="even">
<td align="left">South Africa</td>
<td align="left">ZA</td>
<td align="left">Johannesburg</td>
</tr>
</tbody>
</table>
</div>
<div id="user-selection" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> User selection</h2>
<p>Here, we restrict our sample <a href="mobility.html#selection">7.2</a> of individuals to only active users (as defined in the previous chapter) who had a home location in the city at any given time. It’s important to note that although we use the term <em>city</em> we are using the whole extent of their metropolitan
area.</p>
<p>In order to determine a wealth group for them we take the administrative unit they had at the moment when their home
location was in the city and in case they had more than one we only kept the one where the most time was spent.
The wealth percentiles represent the cummulative population of the administrative units ordered by their wealth index.
This means that users that fall into the <em>Low [0%-40%]</em> group are the ones with their house in the areas with the
lowest wealth index that make up to <span class="math inline">\(40\%\)</span> of the population.</p>
</div>
<div id="code-2" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Code</h2>
<p>We select the largest city and break their wealth index in 3 bins. And define a column to discern from urban and rural places.
The bins and labels are the same as the ones from the previous chapter <a href="mobility.html#mobility">7</a>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="migration.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_admin(country):</span>
<span id="cb18-2"><a href="migration.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  admin_path <span class="op">=</span> <span class="ss">f&#39;/mnt/Geospatial/admin/</span><span class="sc">{</span>country<span class="sc">}</span><span class="ss">/admin.csv&#39;</span></span>
<span id="cb18-3"><a href="migration.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  admin <span class="op">=</span> spark.read.option(<span class="st">&#39;header&#39;</span>, <span class="st">&#39;true&#39;</span>).csv(admin_path)</span>
<span id="cb18-4"><a href="migration.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  admin <span class="op">=</span> (admin</span>
<span id="cb18-5"><a href="migration.html#cb18-5" aria-hidden="true" tabindex="-1"></a>           .withColumn(<span class="st">&#39;urban/rural&#39;</span>, F.when(col(<span class="st">&#39;metro_area_name&#39;</span>).isNull(), lit(<span class="st">&#39;rural&#39;</span>)).otherwise(lit(<span class="st">&#39;urban&#39;</span>)))</span>
<span id="cb18-6"><a href="migration.html#cb18-6" aria-hidden="true" tabindex="-1"></a>           .select(<span class="st">&#39;geom_id&#39;</span>, <span class="st">&#39;urban/rural&#39;</span>))</span>
<span id="cb18-7"><a href="migration.html#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> admin</span>
<span id="cb18-8"><a href="migration.html#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="migration.html#cb18-9" aria-hidden="true" tabindex="-1"></a>admins, admins_by_metro_area, pops <span class="op">=</span> process_admin(country)</span>
<span id="cb18-10"><a href="migration.html#cb18-10" aria-hidden="true" tabindex="-1"></a>admins[<span class="st">&#39;geom_id&#39;</span>] <span class="op">=</span> admins[<span class="st">&#39;geom_id&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb18-11"><a href="migration.html#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="migration.html#cb18-12" aria-hidden="true" tabindex="-1"></a>admins_by_metro_area[<span class="st">&#39;wealth_label&#39;</span>] <span class="op">=</span> pd.cut(admins_by_metro_area[<span class="st">&#39;pct_wealth&#39;</span>], bins_wealth, labels<span class="op">=</span>labels_wealth)</span>
<span id="cb18-13"><a href="migration.html#cb18-13" aria-hidden="true" tabindex="-1"></a>admins_by_metro_area[<span class="st">&#39;geom_id&#39;</span>] <span class="op">=</span> admins_by_metro_area[<span class="st">&#39;geom_id&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb18-14"><a href="migration.html#cb18-14" aria-hidden="true" tabindex="-1"></a>admins_by_metro_area[<span class="st">&#39;wealth_label&#39;</span>] <span class="op">=</span> admins_by_metro_area[<span class="st">&#39;wealth_label&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb18-15"><a href="migration.html#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="migration.html#cb18-16" aria-hidden="true" tabindex="-1"></a>admins_by_metro_area <span class="op">=</span> admins_by_metro_area.loc[admins_by_metro_area.metro_area_name <span class="op">==</span> pops.reset_index().metro_area_name[<span class="dv">0</span>]]</span>
<span id="cb18-17"><a href="migration.html#cb18-17" aria-hidden="true" tabindex="-1"></a>admins <span class="op">=</span> spark.createDataFrame(admins_by_metro_area).select(<span class="st">&#39;geom_id&#39;</span>, <span class="st">&#39;wealth_label&#39;</span>)</span>
<span id="cb18-18"><a href="migration.html#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="migration.html#cb18-19" aria-hidden="true" tabindex="-1"></a>admin_rural <span class="op">=</span> read_admin(country)</span></code></pre></div>
<p>Then we select our user sample, which are the ones with a minimum percentage of active days (<span class="math inline">\(20\%\)</span>) using the same function
<code>get_active_list()</code> and select the users with a home in the city.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="migration.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get list of active users</span></span>
<span id="cb19-2"><a href="migration.html#cb19-2" aria-hidden="true" tabindex="-1"></a>personal_nf <span class="op">=</span> <span class="ss">f&quot;personal_stop_location_hw</span><span class="sc">{hw}</span><span class="ss">_ww</span><span class="sc">{ww}</span><span class="ss">_wa</span><span class="sc">{wa}</span><span class="ss">_mph</span><span class="sc">{</span>mph<span class="sc">}</span><span class="ss">_mpw</span><span class="sc">{</span>mpw<span class="sc">}</span><span class="ss">&quot;</span></span>
<span id="cb19-3"><a href="migration.html#cb19-3" aria-hidden="true" tabindex="-1"></a>stops <span class="op">=</span> spark.read.parquet(<span class="ss">f&quot;</span><span class="sc">{</span>stop_path<span class="sc">}{</span>country<span class="sc">}</span><span class="ss">/accuracy100_maxtimestop3600_staytime300_radius50_dbscanradius50/date</span><span class="sc">{</span>data_date<span class="sc">}</span><span class="ss">/&quot;</span> <span class="op">+</span> personal_nf)</span>
<span id="cb19-4"><a href="migration.html#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="migration.html#cb19-5" aria-hidden="true" tabindex="-1"></a>fname_nf <span class="op">=</span> <span class="ss">f&#39;durations_window_hw</span><span class="sc">{hw}</span><span class="ss">_ww</span><span class="sc">{ww}</span><span class="ss">_wa</span><span class="sc">{wa}</span><span class="ss">_mph</span><span class="sc">{</span>mph<span class="sc">}</span><span class="ss">_mpw</span><span class="sc">{</span>mpw<span class="sc">}</span><span class="ss">&#39;</span></span>
<span id="cb19-6"><a href="migration.html#cb19-6" aria-hidden="true" tabindex="-1"></a>durations_path_nf <span class="op">=</span> <span class="ss">f&#39;</span><span class="sc">{</span>stop_path<span class="sc">}{</span>country<span class="sc">}</span><span class="ss">/accuracy100_maxtimestop3600_staytime300_radius50_dbscanradius50/date</span><span class="sc">{</span>data_date<span class="sc">}</span><span class="ss">/&#39;</span> <span class="op">+</span> fname_nf</span>
<span id="cb19-7"><a href="migration.html#cb19-7" aria-hidden="true" tabindex="-1"></a>durations <span class="op">=</span> spark.read.parquet(durations_path_nf)</span>
<span id="cb19-8"><a href="migration.html#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="migration.html#cb19-9" aria-hidden="true" tabindex="-1"></a>active_users <span class="op">=</span> get_active_list(durations, country, activity_level)</span>
<span id="cb19-10"><a href="migration.html#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="migration.html#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># read stops, filter actives, get most frequented daily geom id, and get rural/urban info</span></span>
<span id="cb19-12"><a href="migration.html#cb19-12" aria-hidden="true" tabindex="-1"></a>admins_by_country, admins_by_metro_area, pop_metro_areas <span class="op">=</span> process_admin(country)</span>
<span id="cb19-13"><a href="migration.html#cb19-13" aria-hidden="true" tabindex="-1"></a>metro <span class="op">=</span> (admins_by_metro_area</span>
<span id="cb19-14"><a href="migration.html#cb19-14" aria-hidden="true" tabindex="-1"></a>         .loc[admins_by_metro_area.metro_area_name <span class="op">==</span> pop_metro_areas</span>
<span id="cb19-15"><a href="migration.html#cb19-15" aria-hidden="true" tabindex="-1"></a>              .reset_index()</span>
<span id="cb19-16"><a href="migration.html#cb19-16" aria-hidden="true" tabindex="-1"></a>              .head(<span class="dv">1</span>)</span>
<span id="cb19-17"><a href="migration.html#cb19-17" aria-hidden="true" tabindex="-1"></a>              .metro_area_name</span>
<span id="cb19-18"><a href="migration.html#cb19-18" aria-hidden="true" tabindex="-1"></a>              .to_list()[<span class="dv">0</span>]][<span class="st">&quot;geom_id&quot;</span>]</span>
<span id="cb19-19"><a href="migration.html#cb19-19" aria-hidden="true" tabindex="-1"></a>         .to_list())</span>
<span id="cb19-20"><a href="migration.html#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="migration.html#cb19-21" aria-hidden="true" tabindex="-1"></a>users_metro <span class="op">=</span> stops.where(col(<span class="st">&#39;location_type&#39;</span>) <span class="op">==</span> <span class="st">&#39;H&#39;</span>).<span class="bu">filter</span>(F.col(<span class="st">&quot;geom_id&quot;</span>).isin(metro)).select(<span class="st">&#39;user_id&#39;</span>).distinct()</span>
<span id="cb19-22"><a href="migration.html#cb19-22" aria-hidden="true" tabindex="-1"></a>stops <span class="op">=</span> stops.join(users_metro, on<span class="op">=</span><span class="st">&#39;user_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;inner&#39;</span>).join(active_users, on<span class="op">=</span><span class="st">&#39;user_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb19-23"><a href="migration.html#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="migration.html#cb19-24" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> Window.partitionBy(<span class="st">&#39;user_id&#39;</span>)</span>
<span id="cb19-25"><a href="migration.html#cb19-25" aria-hidden="true" tabindex="-1"></a>user_geom <span class="op">=</span> (stops</span>
<span id="cb19-26"><a href="migration.html#cb19-26" aria-hidden="true" tabindex="-1"></a>           .where(col(<span class="st">&#39;location_type&#39;</span>) <span class="op">==</span> <span class="st">&#39;H&#39;</span>)</span>
<span id="cb19-27"><a href="migration.html#cb19-27" aria-hidden="true" tabindex="-1"></a>           .<span class="bu">filter</span>(F.col(<span class="st">&quot;geom_id&quot;</span>).isin(metro))</span>
<span id="cb19-28"><a href="migration.html#cb19-28" aria-hidden="true" tabindex="-1"></a>           .groupby(<span class="st">&#39;user_id&#39;</span>, <span class="st">&#39;geom_id&#39;</span>)</span>
<span id="cb19-29"><a href="migration.html#cb19-29" aria-hidden="true" tabindex="-1"></a>           .agg(F.countDistinct(<span class="st">&#39;date_trunc&#39;</span>).alias(<span class="st">&#39;n_days&#39;</span>))</span>
<span id="cb19-30"><a href="migration.html#cb19-30" aria-hidden="true" tabindex="-1"></a>           .withColumn(<span class="st">&#39;max_days&#39;</span>, F.<span class="bu">max</span>(<span class="st">&#39;n_days&#39;</span>).over(w))</span>
<span id="cb19-31"><a href="migration.html#cb19-31" aria-hidden="true" tabindex="-1"></a>           .where(col(<span class="st">&#39;n_days&#39;</span>) <span class="op">==</span> col(<span class="st">&#39;max_days&#39;</span>))</span>
<span id="cb19-32"><a href="migration.html#cb19-32" aria-hidden="true" tabindex="-1"></a>           .groupby(<span class="st">&#39;user_id&#39;</span>)</span>
<span id="cb19-33"><a href="migration.html#cb19-33" aria-hidden="true" tabindex="-1"></a>           .agg(F.first(<span class="st">&#39;geom_id&#39;</span>).alias(<span class="st">&#39;geom_id&#39;</span>))</span>
<span id="cb19-34"><a href="migration.html#cb19-34" aria-hidden="true" tabindex="-1"></a>           .join(admins, on<span class="op">=</span><span class="st">&#39;geom_id&#39;</span>)</span>
<span id="cb19-35"><a href="migration.html#cb19-35" aria-hidden="true" tabindex="-1"></a>           .drop(<span class="st">&#39;geom_id&#39;</span>))</span>
<span id="cb19-36"><a href="migration.html#cb19-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-37"><a href="migration.html#cb19-37" aria-hidden="true" tabindex="-1"></a>usrs <span class="op">=</span>  (user_geom</span>
<span id="cb19-38"><a href="migration.html#cb19-38" aria-hidden="true" tabindex="-1"></a>       .join(active_users, on<span class="op">=</span><span class="st">&#39;user_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb19-39"><a href="migration.html#cb19-39" aria-hidden="true" tabindex="-1"></a>       .toPandas())</span>
<span id="cb19-40"><a href="migration.html#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="migration.html#cb19-41" aria-hidden="true" tabindex="-1"></a>usrs[<span class="st">&quot;country&quot;</span>] <span class="op">=</span> country</span>
<span id="cb19-42"><a href="migration.html#cb19-42" aria-hidden="true" tabindex="-1"></a>usr_df <span class="op">=</span> pd.concat([usr_df, usrs])</span>
<span id="cb19-43"><a href="migration.html#cb19-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-44"><a href="migration.html#cb19-44" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> Window.partitionBy(<span class="st">&#39;user_id&#39;</span>, <span class="st">&#39;date_trunc&#39;</span>)</span>
<span id="cb19-45"><a href="migration.html#cb19-45" aria-hidden="true" tabindex="-1"></a>h_stops <span class="op">=</span> (stops</span>
<span id="cb19-46"><a href="migration.html#cb19-46" aria-hidden="true" tabindex="-1"></a>         .where(col(<span class="st">&#39;location_type&#39;</span>) <span class="op">==</span> <span class="st">&#39;H&#39;</span>)</span>
<span id="cb19-47"><a href="migration.html#cb19-47" aria-hidden="true" tabindex="-1"></a>         .join(active_users, on<span class="op">=</span><span class="st">&#39;user_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb19-48"><a href="migration.html#cb19-48" aria-hidden="true" tabindex="-1"></a>         .groupby(<span class="st">&#39;user_id&#39;</span>, <span class="st">&#39;date_trunc&#39;</span>, <span class="st">&#39;geom_id&#39;</span>)</span>
<span id="cb19-49"><a href="migration.html#cb19-49" aria-hidden="true" tabindex="-1"></a>         .agg(F.<span class="bu">sum</span>(<span class="st">&#39;duration&#39;</span>).alias(<span class="st">&#39;duration&#39;</span>))</span>
<span id="cb19-50"><a href="migration.html#cb19-50" aria-hidden="true" tabindex="-1"></a>         .withColumn(<span class="st">&#39;max_duration&#39;</span>, F.<span class="bu">max</span>(<span class="st">&#39;duration&#39;</span>).over(w))</span>
<span id="cb19-51"><a href="migration.html#cb19-51" aria-hidden="true" tabindex="-1"></a>         .where(col(<span class="st">&#39;duration&#39;</span>) <span class="op">==</span> col(<span class="st">&#39;max_duration&#39;</span>))</span>
<span id="cb19-52"><a href="migration.html#cb19-52" aria-hidden="true" tabindex="-1"></a>         .groupby(<span class="st">&#39;user_id&#39;</span>, <span class="st">&#39;date_trunc&#39;</span>)</span>
<span id="cb19-53"><a href="migration.html#cb19-53" aria-hidden="true" tabindex="-1"></a>         .agg(F.first(<span class="st">&#39;geom_id&#39;</span>).alias(<span class="st">&#39;geom_id&#39;</span>))</span>
<span id="cb19-54"><a href="migration.html#cb19-54" aria-hidden="true" tabindex="-1"></a>         .join(admin_rural, on<span class="op">=</span><span class="st">&#39;geom_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;inner&#39;</span>)</span>
<span id="cb19-55"><a href="migration.html#cb19-55" aria-hidden="true" tabindex="-1"></a>         .join(user_geom, on<span class="op">=</span><span class="st">&#39;user_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;inner&#39;</span>))</span></code></pre></div>
<p>Now that we have defined the home locations of each user we compare the location of the homes from one day
to the one a day before. We are interested in migrations to rural areas, so this time we’re not taking into account
if they moved to a different urban area. Then we put a flag on each user every day to tell if they moved or not and if
they did, knowing if they moved from an urban area to a rural one or the other way around.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="migration.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look-up previous geom id to identify migrations with direction</span></span>
<span id="cb20-2"><a href="migration.html#cb20-2" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> Window.partitionBy(<span class="st">&#39;user_id&#39;</span>).orderBy(<span class="st">&#39;date_trunc&#39;</span>)</span>
<span id="cb20-3"><a href="migration.html#cb20-3" aria-hidden="true" tabindex="-1"></a>h_stops <span class="op">=</span> (h_stops</span>
<span id="cb20-4"><a href="migration.html#cb20-4" aria-hidden="true" tabindex="-1"></a>         .withColumn(<span class="st">&#39;prev_geom_id&#39;</span>, F.lag(<span class="st">&#39;geom_id&#39;</span>, offset<span class="op">=</span><span class="dv">1</span>).over(w))</span>
<span id="cb20-5"><a href="migration.html#cb20-5" aria-hidden="true" tabindex="-1"></a>         .withColumn(<span class="st">&#39;prev_urban/rural&#39;</span>, F.lag(<span class="st">&#39;urban/rural&#39;</span>, offset<span class="op">=</span><span class="dv">1</span>).over(w))</span>
<span id="cb20-6"><a href="migration.html#cb20-6" aria-hidden="true" tabindex="-1"></a>         .withColumn(<span class="st">&#39;prev_date&#39;</span>, F.lag(<span class="st">&#39;date_trunc&#39;</span>, offset<span class="op">=</span><span class="dv">1</span>).over(w))</span>
<span id="cb20-7"><a href="migration.html#cb20-7" aria-hidden="true" tabindex="-1"></a>         .where(col(<span class="st">&#39;prev_geom_id&#39;</span>).isNotNull())</span>
<span id="cb20-8"><a href="migration.html#cb20-8" aria-hidden="true" tabindex="-1"></a>         .withColumn(<span class="st">&#39;change&#39;</span>, F.when(col(<span class="st">&#39;urban/rural&#39;</span>) <span class="op">==</span> col(<span class="st">&#39;prev_urban/rural&#39;</span>), <span class="st">&#39;no change&#39;</span>)</span>
<span id="cb20-9"><a href="migration.html#cb20-9" aria-hidden="true" tabindex="-1"></a>                                .otherwise(F.when(col(<span class="st">&#39;urban/rural&#39;</span>) <span class="op">==</span> <span class="st">&#39;urban&#39;</span>, <span class="st">&#39;rural to urban&#39;</span>)</span>
<span id="cb20-10"><a href="migration.html#cb20-10" aria-hidden="true" tabindex="-1"></a>                                            .otherwise(F.when(col(<span class="st">&#39;urban/rural&#39;</span>) <span class="op">==</span> <span class="st">&#39;rural&#39;</span>, <span class="st">&#39;urban to rural&#39;</span>))))</span>
<span id="cb20-11"><a href="migration.html#cb20-11" aria-hidden="true" tabindex="-1"></a>         .withColumn(<span class="st">&#39;gap&#39;</span>, F.datediff(col(<span class="st">&#39;date_trunc&#39;</span>), col(<span class="st">&#39;prev_date&#39;</span>)))</span>
<span id="cb20-12"><a href="migration.html#cb20-12" aria-hidden="true" tabindex="-1"></a>         .withColumn(<span class="st">&#39;rand_gap&#39;</span>, (<span class="op">-</span><span class="dv">1</span><span class="op">*</span>F.rand()<span class="op">*</span>(col(<span class="st">&#39;gap&#39;</span>)<span class="op">-</span><span class="dv">1</span>)).astype(IntegerType()))</span>
<span id="cb20-13"><a href="migration.html#cb20-13" aria-hidden="true" tabindex="-1"></a>         .withColumn(<span class="st">&#39;new_date&#39;</span>, F.expr(<span class="st">&quot;date_add(date_trunc, rand_gap)&quot;</span>))</span>
<span id="cb20-14"><a href="migration.html#cb20-14" aria-hidden="true" tabindex="-1"></a>         .withColumn(<span class="st">&#39;date_trunc&#39;</span>, col(<span class="st">&#39;new_date&#39;</span>)))</span></code></pre></div>
<p>Finally we only group the number of changes by date and wealth group.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="migration.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate by day and change and return as pandas df</span></span>
<span id="cb21-2"><a href="migration.html#cb21-2" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> (h_stops</span>
<span id="cb21-3"><a href="migration.html#cb21-3" aria-hidden="true" tabindex="-1"></a>     .groupby(<span class="st">&#39;date_trunc&#39;</span>, <span class="st">&#39;wealth_label&#39;</span>, <span class="st">&#39;change&#39;</span>)</span>
<span id="cb21-4"><a href="migration.html#cb21-4" aria-hidden="true" tabindex="-1"></a>     .agg(F.countDistinct(<span class="st">&#39;user_id&#39;</span>).alias(<span class="st">&#39;n_users&#39;</span>))</span>
<span id="cb21-5"><a href="migration.html#cb21-5" aria-hidden="true" tabindex="-1"></a>     .withColumnRenamed(<span class="st">&#39;date_trunc&#39;</span>, <span class="st">&#39;date&#39;</span>)</span>
<span id="cb21-6"><a href="migration.html#cb21-6" aria-hidden="true" tabindex="-1"></a>     .toPandas())</span>
<span id="cb21-7"><a href="migration.html#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="migration.html#cb21-8" aria-hidden="true" tabindex="-1"></a>out[<span class="st">&#39;country&#39;</span>] <span class="op">=</span> country</span></code></pre></div>
<p>Finally, we compute the cumulative percentage change of the difference between the individuals going to rural areas and
the ones to urban areas. This way we get the net rural migration percentage.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:migration-fig"></span>
<img src="big-daa_files/figure-html/migration-fig-1.png" alt="Results for six different cities São Paulo, Bogota, Jakarta, Mexico City, Quezon City (Manila), and Johannesburg. Measuring: Net rural migration in the fraction of people who lived in the city at any point in time. The three coloured lines distinguishes the metric changes for the three different socio-economic groups." width="80%" />
<p class="caption">
Figure 8.1: Results for six different cities São Paulo, Bogota, Jakarta, Mexico City, Quezon City (Manila), and Johannesburg. Measuring: Net rural migration in the fraction of people who lived in the city at any point in time. The three coloured lines distinguishes the metric changes for the three different socio-economic groups.
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mobility.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="optimization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/worldbank/SDG-big-data/07-migration.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["big-daa.pdf", "big-daa.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
